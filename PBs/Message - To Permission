"100601":"<p align=justify><b>IDENTIFICAÇÃO:</b>\n Detecção de uso ilegal de API pelo Trellix Endpoint Security, indicando tentativa ou sucesso de evasão ou execução maliciosa via PowerShell. \n \n <b>ETAPAS DO ATAQUE:</b>\n 1. O atacante pode estar tentando, ou já está tentando, infiltrar-se em máquinas de interesse, explorando vulnerabilidades (ex: phishing, credenciais fracas) ou até mesmo acessando o sistema por meio de contas com privilégios.\n 2. O atacante pode executar comandos PowerShell contornando as políticas de execução, o que permite evitar restrições, manter o shell ativo para persistência e realizar movimentação lateral na rede, alcançando outras máquinas (pivoting).\n 3. É possível que o atacante utilize uma API suspeita ou incomum para injetar código em outros processos, preparar a coleta de informações e executar ações correlatas.\n 4. O atacante busca utilizar comandos legítimos e binários assinados para ocultar a presença do ataque, manter acesso por meio de serviços e tarefas agendadas do Windows e evitar a detecção por soluções antivírus, já que as ações aparentam ser legítimas.\n 5. or fim, o atacante pode executar scripts de Comando e Controle (C2), permitindo a execução de payloads adicionais (como malwares) e a criação de túneis para facilitar outros vetores de ataque.\n \n <b>AVALIAÇÃO:</b>\n [01] - ID da regra: {rule:id} \n [02] - Aviso por e-mail: {rule:mail} \n [03] - Grupo: {rule:groups} \n [04] - Id do Agente: {agent:id}\n [05] - Nome do Agente: {agent:name} \n [06] - Nome do Manager: {manager:name} \n [07] - Nome da Máquina: {data:machine_name}\n [08] - Endereço de Ip: {data:ip.address}\n [09] - Sistema Operacional: {data:os.name}\n [10] - Nome de Usuário: {data:username}\n [11] - Endereço Mac: {data:mac_address}\n [12] - Nome do Produto: {data:product_name}\n [13] - Família do Produto: {data:product_family}\n [14] - Versão do Produto: {data:product_version}\n [15] - Tipo de Analisador: {data:Analyzer}\n [16] - Nome do Analizador: {data:AnalyzerName}\n [17] - Versão do Analisador: {data:AnalyzerVersion}\n [18] - Hostname do Analisador: {data:AnalyzerHostName}\n [19] - Método de Detecção do Analisador: {data:AnalyzerDetectionMethod}\n [20] - Id do Evento: {data:EventID}\n [21] - Severidade do Evento: {data:Severity}\n [22] - Categoria da Ameaça: {data:ThreatCategory}\n [23] - Nome da Ameaça: {data:ThreatName}\n [24] - Tipo da Ameaça: {data:ThreatType}\n [25] - Ação Tomada: {data:ThreatActionTaken}\n [26] - Ameaça Tratada: {data:ThreatHandled}\n [27] - Hostname Alvo: {data:TargetHostName}\n [28] - Username Alvo: {data:TargetUserName}\n [29] - ProcessName Alvo: {data:TargetProcessName}\n [30] - Nome do Alvo: {data:TargetName}\n [31] - Caminho do Alvo: {data:TargetPath}\n [32] - Hash do Alvo: {data:TargetHash}\n [33] - Informações da Máquina : {data:MachineInfo}\n [34] - Descrição em Linguagem Natural: {data:NaturalLangDescription}\n [35] - Má Reputação de IP Origem (Indicador): {abuseipdb:found} \n [36] - Má Reputação de IP Origem (Nível): {abuseipdb:abuse_confidence_score}\n [37] - Má Reputação de IP Origem (Domínio): {abuseipdb:domain} \n [38] - Má Reputação de IP Origem (Ocorrências): {abuseipdb:total_reports}  \n [39] - Má Reputação de IP Origem (Última ocorrência): {abuseipdb:last_reported_at}\n [40] - Tipo de IP Origem: {abuseipdb:usage_type} \n [41] - ISP de Origem: {abuseipdb:isp} \n [42] - Código de País do IP Origem: {abuseipdb:country_code}\n \n <b>MITIGAÇÃO:</b> \n 1. Aplicar políticas de restrição de execução do  uso do PowerShell via GPO e até desabilitar o PowerShell em servidores que não exigem seu uso administrativo diário.\n 2. Habilitar e Monitorar o PowerShell Logging, garantindo que a ativação dos logs e as regras de alerta do Siem estão bem definidas para esse tipo de evento.\n 3. Bloquear execuçoes suspeitas com técnicas de EDR  para  monitorar continuamente os dispositivos do usuário final  e responder a ameaças já inseridas ou que estão encaminhadas, como ransomware e malware.\n 4. Implementar ou revisar o  sistema de controle de permissividade das aplicações, ou seja, criar uma whitelist, de quais scripts e binários quando pré aprovados podem operar, evitando execução de fgerramentas como o PowerShell de locais não esperados.\n 5. Verificar a atualização das suas politicas de segurança e do Sistema Operacional (OS), migrando para sistemas suportados ou até mesmo aplicar "Hardening", diminuindo a superfície de ataque.\n \n <b>CONTENÇÃO:</b> \n 1. Assim que for confirmado ou fortemente suspeitado o uso malicioso de PowerShell e técnicas evasivas, a primeira medida é isolar o host, da rede\n 2. Por haver o risco do atacante já ter escalado privilégios, é de suma importância revogar as sessões e credenciais ativas no momento. Alterar senhas de contas locais e administrativas, especialmente se forem compartilhadas ou mal gerenciadas\n 3. Validar integridade de arquivos no caminho do PowerShell com hashes e timestamp além de encerrar qualquer instância dos terminais ativos.\n 4. Reiniciar o sistema e antes de reiniciar ou alterar o sistema, deve-se capturar dados de memória, processos e conexões para permitir análise forense posterior como lista de processos em execução ou conexões de rede abertas.\n 5. Aplicar políticas temporárias de contenção via GPO ou EDR além de aplicar a restrição às execuções de terminal.\n \n <b>CONCLUSÃO:</b> A detecção de uso ilegal de API pelo Trellix Endpoint Security indica claramente uma tentativa de execução maliciosa via PowerShell, empregando técnicas de evasão de segurança e uso de recursos legítimos do sistema para burlar os mecanismos de defesa. O uso de parâmetros de Politicas de execução em conjunto com uma chamada de API suspeita, revela um padrão compatível com táticas de Living off the Land (LotL) e execução fileless, estratégias típicas de agentes de ameaça avançados que buscam manter a discrição em ambientes corporativos.  As evidências apontam que o atacante já possui algum grau de acesso, com execução sob contexto do NT AUTHORITY\SYSTEM e está explorando esse acesso para persistência, movimento lateral e possível execução de comandos remotos via C2. A tentativa de mascarar as ações com binários assinados e ferramentas nativas, como powershell.exe e cmd.exe, mostra o uso de técnicas de ofuscação e mimetismo do comportamento administrativo.</p>",
"100116":"<p align=justify><b>IDENTIFICAÇÃO:</b>\n A atividade registrada envolve uma conexão persistente e vulnerável com alto consumo de banda, sinalizando possíveis comportamentos evasivos, conforme detectado pelo tráfego para uma aplicação web. O incidente indicado pela regra pode refletir tentativas de burlar controles de segurança usando técnicas que exploram vulnerabilidades conhecidas. Isso sugere a intenção dos atacantes de ocultar atividades maliciosas ou de malware, potencializando o uso de largura de banda para operações que podem incluir a disseminação de malware ou exfiltração de dados. O impacto real ou potencial inclui comprometimento de dados confidenciais, violação de compliances, e possível infecção de outros sistemas na rede.\n \n <b>ETAPAS DO ATAQUE:</b>\n 1. Revisão e fortalecimento das políticas de segurança para detectar e bloquear tráfego suspeito.\n 2. Implementação de inspeção profunda de pacotes para análise detalhada do tráfego.\n 3. Atualização e rigor na aplicação das políticas de restrições baseadas em IP para prevenir abusos.\n 4. Utilização de sistemas de detecção e prevenção de intrusões para responder em tempo real a ameaças.\n 5. Treinamento e conscientização dos usuários sobre os riscos associados ao acesso a aplicativos de mídia de alto risco.\n 6. Monitoramento contínuo e análise de comportamento de rede para identificar padrões anormais de tráfego.\n \n <b>AVALIAÇÃO:</b>\n [01] - Endereço Origem: {data:src_ip}\n [02] - Endereço Destino: {data:dst_ip}\n [03] - Ip do NAT Origem: {data:nat_source_ip}\n [04] - Ip do NAT destino: {data:nat_destination_ip}\n [05] - Aplicação: {data:application}\n [06] - Porta de Destino dos Dados: {data:dst_port}\n [07] - Porta de Origem do NAT dos Dados: {data:nat_source_port}\n [08] - Porta de Destino do NAT dos Dados: {data:nat_destination_port}\n [09] - Protocolo de Rede: {data:ip_protocol}\n [10] - Verificação: {data:category}\n [11] - País de Origem dos Dados: {data:source_location}\n [12] - País de Destino dos Dados: {data:destination_location}\n [13] - Nome da Máquina Virtual: {data:virtual_system_name}\n [14] - Nome Dispositivo: {data:device_name}\n [15] - Categoria da Aplicação: {data:application_category}\n [16] - Tecnologia da Aplicação: {data:application_technology}\n [17] - Características da Aplicação: {data:application_characteristics}\n [18] - Dados da Aplicação Encapsulada: {data:tunneled_application} \n [19] - Má Reputação de IP Origem (Indicador): {abuseipdb:found}\n [20] - Má Reputação de IP Origem (Nível): {abuseipdb:abuseConfidenceScore} \n [21] - Má Reputação de IP Origem (Domínio): {abuseipdb:domain} \n [22] - Má Reputação de IP Origem (Ocorrências): {abuseipdb:totalReports} \n [23] - Má Reputação de IP Origem (Última ocorrência): {abuseipdb:lastReportedAt} \n [24] - Tipo de IP Origem: {abuseipdb:usageType} \n [25] - ISP: {abuseipdb:isp} \n [26] - Código de País do IP: {abuseipdb:countryCode} \n \n <b>MITIGAÇÃO:</b>\n 1. Restringir o uso de aplicações de alto risco e com vulnerabilidades conhecidas através de firewalls e listas de controle de acesso.\n 2. Implementar gateways de web seguros para inspecionar e filtrar conteúdo malicioso em tráfego criptografado.\n 3. Realizar atualizações regulares de firmware e software para corrigir vulnerabilidades em dispositivos e aplicações.\n 4. Reforçar as configurações de segurança nos dispositivos de rede para bloquear conexões não autorizadas.\n 5. Estabelecer políticas de uso aceitável para limitar o acesso a sites e aplicativos baseados em riscos associados.\n \n <b>CONTENÇÃO:</b> \n 1. Isolamento rápido de dispositivos infectados ou comprometidos para prevenir a propagação de malware.\n 2. Utilização de soluções de sandboxing para executar e testar tráfego suspeito em um ambiente controlado.\n 3. Bloqueio imediato de IPs e domínios conhecidos por distribuir malware ou realizar atividades maliciosas.\n \n<b>CONCLUSÃO:</b> A análise destaca a necessidade crítica de vigilância e resposta rápida a tráfegos criptografados potencialmente maliciosos. A persistência e vulnerabilidade da conexão detectada indicam tentativas de exploração de largura de banda para atividades nocivas, enfatizando a importância de estratégias proativas de segurança e conformidade regulatória para proteger a integridade da rede e dos dados.</p>",
